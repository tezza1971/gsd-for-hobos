---
phase: 01-foundation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - tsconfig.json
  - tsup.config.ts
  - src/cli.ts
  - src/lib/exit-codes.ts
  - src/lib/logger.ts
  - src/lib/paths.ts
  - src/types/index.ts
autonomous: true
user_setup: []

must_haves:
  truths:
    - "User can run `npx tsx src/cli.ts --help` and see usage information"
    - "User can run `npx tsx src/cli.ts --version` and see version 0.1.0"
    - "User can run with `-v` flag and verbose logging is enabled"
    - "User can run with `-q` flag and only errors are shown"
    - "User can run with `--dry-run` flag (accepted, no-op for now)"
  artifacts:
    - path: "package.json"
      provides: "npm project config with bin field for npx execution"
      contains: "gsd-open"
    - path: "tsconfig.json"
      provides: "TypeScript configuration for ESM output"
      contains: "ESNext"
    - path: "tsup.config.ts"
      provides: "Build configuration for distribution"
      contains: "tsup"
    - path: "src/cli.ts"
      provides: "Main CLI entry point with Commander.js"
      exports: ["program"]
    - path: "src/lib/exit-codes.ts"
      provides: "Exit code constants"
      exports: ["ExitCode"]
    - path: "src/lib/logger.ts"
      provides: "Logging with verbose/quiet support"
      exports: ["log", "setLogLevel", "LogLevel"]
    - path: "src/lib/paths.ts"
      provides: "Cross-platform path utilities"
      exports: ["paths", "pathExists"]
  key_links:
    - from: "src/cli.ts"
      to: "src/lib/logger.ts"
      via: "import setLogLevel"
      pattern: "import.*setLogLevel.*from.*logger"
    - from: "src/cli.ts"
      to: "src/lib/exit-codes.ts"
      via: "import ExitCode"
      pattern: "import.*ExitCode.*from.*exit-codes"
---

<objective>
Create the foundational CLI skeleton for gsd-open with all standard flags working.

Purpose: Establish the npm package structure and CLI entry point that all subsequent phases build upon. This is the foundation that makes everything else possible.

Output: A working TypeScript CLI that responds to --help, --version, -v, -q, and --dry-run flags with proper exit code handling.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-foundation/01-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Initialize npm project with TypeScript toolchain</name>
  <files>
    package.json
    tsconfig.json
    tsup.config.ts
  </files>
  <action>
    Create package.json with:
    - name: "gsd-open"
    - version: "0.1.0"
    - type: "module" (ESM)
    - bin: { "gsdo": "./dist/cli.js" }
    - files: ["dist"]
    - engines: { "node": ">=20" }
    - scripts: dev (tsx), build (tsup), test (vitest)
    - dependencies: commander ^14.0.2, @clack/prompts ^0.11.0, picocolors ^1.1.1
    - devDependencies: typescript ^5.7.0, tsx ^4.0.0, tsup ^8.0.0, vitest ^4.0.17, @types/node ^20.0.0

    Create tsconfig.json with:
    - target: "ESNext"
    - module: "NodeNext"
    - moduleResolution: "NodeNext"
    - strict: true
    - esModuleInterop: true
    - outDir: "./dist"
    - rootDir: "./src"
    - declaration: true

    Create tsup.config.ts with:
    - entry: ["src/cli.ts"]
    - format: ["esm"]
    - dts: true
    - clean: true
    - shims: true (for __dirname in ESM)

    Run `npm install` to install dependencies.

    AVOID: Do not use chalk (ESM complications). Use picocolors instead.
    AVOID: Do not add Jest - use Vitest for faster execution.
  </action>
  <verify>
    - `npm run dev -- --help` executes without TypeScript errors
    - package.json has all required fields
    - node_modules/ directory exists with dependencies
  </verify>
  <done>
    Project initializes, TypeScript compiles, dependencies installed.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create core library modules (exit-codes, logger, paths)</name>
  <files>
    src/lib/exit-codes.ts
    src/lib/logger.ts
    src/lib/paths.ts
    src/types/index.ts
  </files>
  <action>
    Create src/types/index.ts with:
    - CLIOptions interface: { verbose: boolean; quiet: boolean; dryRun: boolean }

    Create src/lib/exit-codes.ts with:
    - ExitCode const object: SUCCESS=0, WARNING=1, ERROR=2, FATAL=3
    - Type: ExitCodeValue = typeof ExitCode[keyof typeof ExitCode]

    Create src/lib/logger.ts with:
    - LogLevel enum: QUIET=0, NORMAL=1, VERBOSE=2
    - Module-level currentLevel variable (default NORMAL)
    - setLogLevel(verbose: boolean, quiet: boolean) function
    - log object with methods: error (always), warn (>=NORMAL), info (>=NORMAL), success (>=NORMAL), verbose (>=VERBOSE)
    - Use picocolors for colors: error=red, warn=yellow, success=green, verbose=dim

    Create src/lib/paths.ts with:
    - Use `import { join } from 'node:path'` and `import { homedir } from 'node:os'`
    - paths object with functions: gsdDir(), gsdCommands(), openCodeConfig() (platform-aware)
    - pathExists(path: string): Promise<boolean> using fs/promises access()

    CRITICAL: Use `node:path` and `node:os` prefixes (Node.js built-in module convention).
    CRITICAL: Always use path.join() - never hardcode separators.
    CRITICAL: openCodeConfig() must check process.platform for Windows vs Unix paths.
  </action>
  <verify>
    - `npx tsx -e "import { ExitCode } from './src/lib/exit-codes.js'; console.log(ExitCode)"` outputs the constants
    - `npx tsx -e "import { log } from './src/lib/logger.js'; log.info('test')"` outputs "test"
    - `npx tsx -e "import { paths } from './src/lib/paths.js'; console.log(paths.gsdDir())"` outputs a valid path
  </verify>
  <done>
    All three library modules export their interfaces correctly and can be imported.
  </done>
</task>

<task type="auto">
  <name>Task 3: Create CLI entry point with Commander.js</name>
  <files>
    src/cli.ts
  </files>
  <action>
    Create src/cli.ts with shebang `#!/usr/bin/env node`:

    Import Commander, setLogLevel from logger, ExitCode from exit-codes.

    Create program with:
    - .name('gsdo')
    - .description('GSD-Open: Transpile Claude Code configs to OpenCode')
    - .version('0.1.0')
    - .option('-v, --verbose', 'enable verbose output')
    - .option('-q, --quiet', 'suppress all output except errors')
    - .option('--dry-run', 'preview changes without writing files')

    In .action(async (options)):
    - Call setLogLevel(options.verbose, options.quiet)
    - Log verbose message if verbose mode
    - Log info "GSD-Open initialized" (placeholder for now)
    - If dryRun, log info "[DRY RUN] Would proceed with transpilation"

    Wrap action in try/catch:
    - On error: log.error(error.message), set process.exitCode = ExitCode.ERROR

    Call program.parse() at end.

    AVOID: Do not call process.exit() directly - use process.exitCode instead.
    AVOID: Do not import version from package.json (ESM complication) - hardcode '0.1.0' for now.
  </action>
  <verify>
    - `npm run dev -- --help` shows help text with all flags
    - `npm run dev -- --version` shows "0.1.0"
    - `npm run dev -- -v` shows verbose output
    - `npm run dev -- -q` shows no output (success is silent)
    - `npm run dev -- --dry-run` shows dry run message
    - Exit code is 0 on success: `npm run dev && echo "Exit: $?"`
  </verify>
  <done>
    CLI entry point works with all flags, proper exit codes, no errors.
  </done>
</task>

</tasks>

<verification>
Run the following to verify Phase 1 Plan 01 completion:

```bash
# Verify help output
npm run dev -- --help

# Verify version
npm run dev -- --version

# Verify verbose mode
npm run dev -- -v

# Verify quiet mode (should be silent on success)
npm run dev -- -q

# Verify dry-run mode
npm run dev -- --dry-run

# Verify build works
npm run build
ls dist/
```

All commands should execute without errors. Help should show all flags. Version should show 0.1.0.
</verification>

<success_criteria>
- [ ] package.json exists with correct name, version, bin field, and all dependencies
- [ ] TypeScript compiles without errors
- [ ] `npm run dev -- --help` shows usage with -v, -q, --dry-run flags
- [ ] `npm run dev -- --version` shows 0.1.0
- [ ] Verbose mode activates with -v flag
- [ ] Quiet mode suppresses output with -q flag
- [ ] Dry-run flag is accepted (placeholder behavior)
- [ ] Exit code is 0 on successful execution
- [ ] `npm run build` produces dist/cli.js
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation/01-01-SUMMARY.md`
</output>
